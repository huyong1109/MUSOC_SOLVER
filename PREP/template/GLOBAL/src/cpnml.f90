SUBROUTINE COPY_NAMELIST(MODEL,NML_ODIR,WORKDIR)
  CHARACTER(len=*) :: MODEL,NML_ODIR,WORKDIR
  CHARACTER*256 :: CMD
! FILENAME AND NAMELIST STRING DEFINITION
  CHARACTER*32 :: FNL_INPUT,FNL_INPUT_CASE
  INTEGER :: IEXIST=0

  CALL CHECK_WORKDIR_EXIST
  IF (IEXIST==1) RETURN
  CALL FNL_DEFINE
  CALL COPY_NAMELIST_TO_WORKDIR

CONTAINS

SUBROUTINE CHECK_WORKDIR_EXIST
  logical :: istat
  CHARACTER*256 :: FN_CASECFG
  FN_CASECFG=TRIM(WORKDIR)//"/.case.cfg"
  INQUIRE(FILE=TRIM(FN_CASECFG),EXIST=istat)
  IF (istat == .FALSE.) THEN
    PRINT *,"Main code dir:",TRIM(WORKDIR)," does NOT generated by timcom_setup!"
    PRINT *,"The namelist for main code will stay in MAIN_NML dir"
    IEXIST=1
  ENDIF
END SUBROUTINE CHECK_WORKDIR_EXIST

SUBROUTINE FNL_DEFINE
  FNL_INPUT="namelist000.run"
  FNL_INPUT_CASE="namelist000.input_"//TRIM(MODEL)
END SUBROUTINE FNL_DEFINE

SUBROUTINE COPY_NAMELIST_TO_WORKDIR
  CHARACTER*256 :: F1,F2
  F1=TRIM(NML_ODIR)//'/'//TRIM(FNL_INPUT)
  F2=TRIM(NML_ODIR)//'/'//TRIM(FNL_INPUT_CASE)
  !WRITE(CMD,"(6A)")"cp ",TRIM(F1)," ",TRIM(F2)," ",TRIM(WORKDIR)
  WRITE(CMD,"(6A)")"cp ",TRIM(NML_ODIR),"/* ",TRIM(WORKDIR)
  CALL SYSTEM(TRIM(CMD))
  WRITE(CMD,"(6A)")"cp ",TRIM(NML_ODIR),"/.case_info ",TRIM(WORKDIR)
  CALL SYSTEM(TRIM(CMD))
END SUBROUTINE COPY_NAMELIST_TO_WORKDIR  

END SUBROUTINE COPY_NAMELIST

